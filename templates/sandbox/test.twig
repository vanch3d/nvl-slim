{% extends 'site.twig' %}

{% block injectJS %}
    <script src="//cdn.jsdelivr.net/d3js/3.4.3/d3.min.js"></script>
    <script src="/plugins/d3js/d3.layout.cloud.js"></script>
    <script>

    $(document).ready(function()
    {
        var gg = {{ data|json_encode|raw }};
        console.log(gg);


        var fill = d3.scale.category20();
        var width = $("#d3-container").width(),
                aspect = 500 / 950;
        var svg= null;

        d3.layout.cloud().size([950, 500])
                .words(gg)
                .padding(5)
                .rotate(function() { return ~~(Math.random() * 2) * 90; })
                .font("Impact")
                .fontSize(function(d) { return d.size+10; })
                .on("end", draw)
                .start();

        function draw(words) {
           svg = d3.select("#d3-container").append("svg")
                    .attr("preserveAspectRatio", "xMidYMid")
                    .attr("viewBox", "0 0 950 500")
                    .attr("width", width)
                    .attr("height", width * aspect)
                    .append("g")
                    .attr("transform", "translate(" + [width >> 1, (width*aspect) >> 1] + ")")
                    .selectAll("text")
                    .data(words)
                    .enter().append("text")
                    .style("font-size", function(d) { return d.size + "px"; })
                    .style("font-family", "Impact")
                    .style("fill", function(d, i) { return fill(i); })
                    .attr("text-anchor", "middle")
                    .attr("transform", function(d) {
                        return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
                    })
                    .text(function(d) { return d.text; });

        }

        $(window).resize(function() {
            var width = $("#d3-container").width();
            if (svg) svg.attr("width", width);
            if (svg) svg.attr("height", width * aspect);
        });

    });
    </script>
{%  endblock %}
{% block content %}
    <section class="white-section">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <div class="text-widget">
                        <div class="text-widget-title">
                            <h3>Project Overview</h3>
                        </div>

                        <div class="row gray-section" id="d3-container" style="height: 450px;">
                        </div>

                    </div>
                </div>
            </div>
        </div>
     </section>

{%  endblock %}